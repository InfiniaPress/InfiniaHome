<!DOCTYPE html>
<html>
<head>
    <title>Setup < InfiniaPress</title>
    <script src="https://code.jquery.com/jquery-3.2.1.js"></script>
  	<script src="http://materializecss.com/bin/materialize.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/materialize/0.100.1/css/materialize.min.css">
    <style>
        html{
            margin-left: 10px;
            margin-right: 10px;
			text-align: center;
        }
    </style>
</head>

<body>

<h4>Welcome to InfiniaPress!</h4>
<h5>Before we begin the install, please tell us more about your server and database.</h5>

<p>We have magically guessed your webroot! Please tell us if this is correct</p>

<p>Webroot: <b id="webroot">{{ webroot }}</b></p>

<!-- Buttons Yes/No -->

<button id="yessir" class="waves-effect waves-light btn">Yes</button>
<button id="nofookyou" class="waves-effect waves-light btn">No</button>

<!-- If no: type us the correct webroot and make a save button, disable both buttons and update the webroot variable with jQuery -->

<!-- If yes, disable both the buttons immediately -->


<h4>Tell us about your database</h4>

<div class="input-field col s12">
    <input id="host" type="text" class="validate">
    <label for="host">Your database host:</label>
</div>
<div class="input-field col s12">
    <input id="port" type="text" class="validate">
    <label for="port">Your port:</label>
</div>
<div class="input-field col s12">
    <input id="name" type="text" class="validate">
    <label for="name">The name of your Database:</label>
</div>
<div class="input-field col s12">
    <input id="username" type="text" class="validate">
    <label for="username">Your username for your Database:</label>
</div>
<div class="input-field col s12">
    <input id="password" type="text" class="validate">
    <label for="password">The password for your Database:</label>
</div>

<a class='dropdown-button btn' href='#' data-activates='dropdown1' id="appType">Database type</a>

<ul id='dropdown1' class='dropdown-content'>
  <li><a id="mysql">MySQL</a></li>
  <li><a id="postgresql">PostgreSQL</a></li>
</ul>

<br>
<br>

<button id="submit" class="waves-effect waves-light btn">Save!</button>

<script>
	var dbType;
    $("#mysql").on("click",function(){
        dbType = "mysql";
        $("#appType").text(dbType);
    });
    $("#postgresql").on("click",function(){
        dbType = "pgsql";
        $("#appType").text(dbType);
    });
    $("#submit").click(function(){
		if(!dbType){
			alert("Choose your database type!");
		}else{
        $.ajax({
            type: "POST",
            url: '{{ webroot }}/setup/setup-0',
            data: {dbtype:dbType,host:$("#host").val(),port:$("#port").val(),name:$("#name").val(),username:$("#username").val(),password:$("#password").val(),},
            success: function(result){
                if(result === "true"){
					window.location('{{ webroot }}/setup/setup-1');
				}
            },
            error: function(err){
                alert(err.responseText);
            },
            dataType: "application/json"
        });
		}
    });
</script>

<!--

Type of DB: (Dropdown) MySQL, PostgreSQL (Not recommended for production environments)
Database host:
Database port:
Database name:
Database username:
Database password:

Save button (Returns either True (Connection worked) or False (Connection failed)
-->


</body>
</html>